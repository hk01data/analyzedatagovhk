!function(){"use strict";var t,n,a,o,e,r,i,c,d,l,s,u,p=70,g=100,y=(Math.pow(80,2),5),m=10,b=3,f=g*y+2*m,h=p*y+2*m,v=600,_=6751,x="annotation",w="#999999",I={};I.curr_page=1,I.animator={};var A={good:"#8913db",fair:"#597ddf",lesserrubbish:"#e1e318",lessrubbish:"#e3bb18",rubbish:"#ae8e0c"},S=[{title:"政府「資料一線通」網站內的資料如何發水？",annotation:["按此開始"],annotation_point:[3336],annotation_dxdy:[{dx:1,dy:-2}],range:[{start:0,end:6750,color:w,opacity:.2}]},{title:"根據《香港01》統計，截至2017年3月3日，網站共有6,751項數據資源。",annotation:["一點代表一項資源"],annotation_point:[3330],annotation_dxdy:[!1],range:[{start:0,end:3329,color:w,opacity:.2},{start:3330,end:3330,color:"red",opacity:1},{start:3331,end:6750,color:w,opacity:.2}]},{title:"6,751項資料中，有四分一是圖像檔案，除相片外還包括圖表，市民需額外花時間才能撮取圖表中的數字。",annotation:["JPG,PNG和GIF等檔案 佔1,661項"],annotation_point:[5220],annotation_dxdy:[!1],range:[{start:5087,end:6750,color:A.rubbish,opacity:1},{start:0,end:5086,color:w,opacity:.2}]},{title:"參照互聯網之父柏納斯李爵士的分類，將檔案分為三級，「資料一線通」有6成檔案屬2星級。",annotation:["XLS／XLSX有3,996項"],annotation_point:[1120],annotation_dxdy:[{dx:20,dy:-20}],range:[{start:0,end:1119,color:w,opacity:.2},{start:1120,end:5086,color:A.fair,opacity:1},{start:5087,end:6750,color:A.rubbish,opacity:.4}]},{title:"至於屬最高級別的三星級格式，例如JSON, XML, CSV等，只佔政府開數據的六分一。",annotation:["JSON,XML,CSV 有1,120項"],annotation_point:[1120],annotation_dxdy:[{dx:20,dy:20}],range:[{start:0,end:1119,color:A.good,opacity:1},{start:1120,end:5086,color:A.fair,opacity:.4},{start:5087,end:6750,color:A.rubbish,opacity:.4}]},{title:"「資料一線通」的另一問題是，政府把同一項數據按不同語言分拆成多條資料上載網站。",annotation:["多項資源應歸納為同一個數據資源","","",""],annotation_point:[3310,515,1190,5180],annotation_dxdy:[!1,{dx:60,dy:80},{dx:-50,dy:50},{dx:-80,dy:-100}],range:[{start:0,end:6750,color:w,opacity:function(){return function(){return Math.random()}()}}]},{title:"令「資料一線通」網站有不少資料其實是重覆的。",annotation:["338項拆成2種語言","772項拆成繁簡英3種","45幢建築物分身成810張圖片"],annotation_point:[4104,4631,6087],annotation_dxdy:[{dx:50,dy:-50},{dx:30,dy:-30},{dx:-1,dy:-190}],range:[{start:0,end:4103,color:w,opacity:.2},{start:4104,end:4441,color:A.lesserrubbish,opacity:.8},{start:4442,end:5985,color:A.lessrubbish,opacity:1},{start:5986,end:6750,color:A.rubbish,opacity:1}]},{title:"扣除上述按不同語言分拆上載的資料，網站僅餘4,104項資料。",annotation:["餘下4,104項"],annotation_point:[4103],annotation_dxdy:[{dx:30,dy:30}],range:[{start:0,end:4103,color:A.fair,opacity:1},{start:4104,end:6750,color:w,opacity:.2}]},{title:"再扣除同一組數據，但分拆成不同年份和月份的資料。",annotation:["僅餘2,025項"],annotation_point:[1312],annotation_dxdy:[{dx:70,dy:70}],range:[{start:0,end:2024,color:A.good,opacity:1},{start:2025,end:4103,color:A.fair,opacity:.4},{start:4104,end:6750,color:w,opacity:.2}]},{title:"總結而言，6,751項數據資料扣除「水份」後，只餘下2,025項「真材實料」的資料，即網站有7成資料是水份。",annotation:["357項是三粒星","1,193項是兩粒星"],annotation_point:[204,1312,1970],annotation_dxdy:[{dx:1,dy:190},{dx:70,dy:70}],range:[{start:0,end:356,color:A.good,opacity:1},{start:357,end:1549,color:A.fair,opacity:1},{start:1550,end:2024,color:A.rubbish,opacity:1},{start:2025,end:6750,color:w,opacity:.2}]}];for(t=d3.select("#chart").append("canvas").attr("id","canvas").attr("width",f).attr("height",h),n=t.node().getContext("2d"),c=document.getElementById("chart"),d=document.getElementById("control"),l=document.getElementById("prev-page"),s=document.getElementById("next-page"),u=document.getElementById("nav-group"),a=0;a<S.length;a++){var L=document.createElement("button");L.className="nav-page",L.value=a+1,L.innerHTML=a+1,d.insertBefore(L,u)}o=document.body.offsetWidth||document.body.clientWidth,470>o&&(c.style.transform+=" scale("+(o-.6*m)/470+") ",c.style.transformOrigin=" 0 0 ",c.style.marginBottom=-(100-o/470*100)+"%"),ga("create","UA-67838455-1",{name:"b"}),ga("b.send","pageview",{});var E=document.createElement("p");E.innerHTML=document.body.offsetWidth+", "+document.body.clientWidth+", "+o+" : ";var X=[100,150,200,350,215,179,465,321].sort(function(){return.5-Math.random()}),M=function(t,n){var a=document.getElementById(t);a.innerHTML=n},B=function(t,n,a,o,e,r){e=e.replace("#","");var c=g*y+2*m,d=4*(a*c+n-m);c=4*c,i[d+0]=i[d+0+4+c]=i[d+0+0+c]=i[d+0+4]=parseInt(e.substr(0,2),16),i[d+1]=i[d+1+4+c]=i[d+1+0+c]=i[d+1+4]=parseInt(e.substr(2,2),16),i[d+2]=i[d+2+4+c]=i[d+2+0+c]=i[d+2+4]=parseInt(e.substr(4,2),16),i[d+3]=i[d+3+4+c]=i[d+3+0+c]=i[d+3+4]=255*r,i[d+0+4+2*c]=i[d+0+8+c]=i[d+0+0+2*c]=i[d+0+8]=parseInt(e.substr(0,2),16),i[d+1+4+2*c]=i[d+1+8+c]=i[d+1+0+2*c]=i[d+1+8]=parseInt(e.substr(2,2),16),i[d+2+4+2*c]=i[d+2+8+c]=i[d+2+0+2*c]=i[d+2+8]=parseInt(e.substr(4,2),16),i[d+3+4+2*c]=i[d+3+8+c]=i[d+3+0+2*c]=i[d+3+8]=255*r,i[d+0+8+2*c]=parseInt(e.substr(0,2),16),i[d+1+8+2*c]=parseInt(e.substr(2,2),16),i[d+2+8+2*c]=parseInt(e.substr(4,2),16),i[d+3+8+2*c]=255*r},C=function(t,n){return n},F=function(t,n,a){var o=n,e=n;return.3>n?o=n:(e=X[~~((10*Math.random()+1)%8)]/500*(n-a/v)+a/v,o=t+e*(n-t)),o},N=function(t,n){var a,o,e,c,d,l,s=S[I.curr_page-1];for(i=(r=t.createImageData(f,h)).data,o=0;_>o;o++){if(d=~~(o/g)*y+m,c=o%g*y+m,s.range){for(a=!1,e=0;e<s.range.length&&(s.range[e].start>o||o>s.range[e].end);)e++;e<s.range.length&&(s.range[e].start>o||o>s.range[e].end||(l=C(s.range[e].color,s.range[e].color,n),t.globalAlpha="function"==typeof s.range[e].opacity?F(.2,s.range[e].opacity(),n):F(.2,s.range[e].opacity,n),a=!0))}else l=w,t.globalAlpha=.2,a=!0;a&&B(t,c,d,b,l,t.globalAlpha)}},P=function(t){var a=t-e;v>a?(N(n,a),n.putImageData(r,0,0),I.animator=window.requestAnimationFrame(P)):window.cancelAnimationFrame(I.animator)},W=function(){e=performance.now(),window.requestAnimationFrame(P)},G=function(t,n){"prev"===t?~~I.curr_page-1<1?I.curr_page=S.length-1:I.curr_page--:"next"===t?~~I.curr_page+1>S.length?I.curr_page=1:I.curr_page++:I.curr_page=n;var a=document.querySelector(".nav-page.active");return a&&(a.className="nav-page"),document.querySelector('.nav-page[value="'+I.curr_page+'"]').className+=" active",I.curr_page};d3.select("#chart").on("click",function(){{var t,n="hk01data.github.io"===window.location.hostname?"user-interaction":"interaction";d3.mouse(this)[0],d3.mouse(this)[1]}return window.cancelAnimationFrame(I.animator),t=S[G("next",0)-1],M("ctitle",t.title),W(),q(t.annotation,t.annotation_point,t.annotation_dxdy),ga("b.send","event",n,"click-svg",I.curr_page),!1}),d3.selectAll("#control button").on("click.button",function(t,n,a){var o,e="hk01data.github.io"===window.location.hostname?"user-interaction":"interaction",r=a[n].value;return window.cancelAnimationFrame(I.animator),o=S[G(r,r)-1],M("ctitle",o.title),W(),q(o.annotation,o.annotation_point,o.annotation_dxdy),ga("b.send","event",e,"click-nav",I.curr_page),!1});var q=function(t,n,a){var o,e=document.querySelectorAll("."+x+" *");if(e)for(o=0;o<e.length;o++)e[o].remove();if(t)for(o=0;o<t.length;o++)k(t[o],n[o],a[o])},k=function(t,n,a){var o=~~(n/g)*y+m,e=n%g*y,r=a.dx||30,i=a.dy||-20,c=(d3.annotationCalloutElbow,[{note:{label:t},x:e+b,y:o-b,dx:r,dy:i,type:d3.annotationCalloutElbow}]),d=d3.annotation().annotations(c);d3.select("#chart svg").attr("class",x).append("g").attr("class","annotation-group").call(d)},O=S[G(1,1)-1];W(),q(O.annotation,O.annotation_point,O.annotation_dxdy)}();
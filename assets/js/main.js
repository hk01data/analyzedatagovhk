!function(){"use strict";var t=70,n=100,e=(Math.pow(80,2),5),a=10,o=3,r=n*e+2*a,i=t*e+2*a,d=600,c={};c.curr_page=1,c.animator={},c.isFirefox=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,c.is_uiwebview=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Version)/i.test(navigator.userAgent);var l,s,u,p,y=6751,g=document.getElementById("chart"),f="annotation",m="#999999",b=document.body.offsetWidth||document.body.clientWidth;470>b&&(g.style.transform+=" scale("+(b-.6*a)/470+") ",g.style.transformOrigin=" 0 0 ",g.style.marginBottom=-(100-b/470*100)+"%");var h=document.createElement("p");h.innerHTML=document.body.offsetWidth+", "+document.body.clientWidth+", "+b+" : "+c.is_uiwebview;var v={good:"#8913db",fair:"#597ddf",lesserrubbish:"#e1e318",lessrubbish:"#e3bb18",rubbish:"#ae8e0c"},_=[{title:"「資料一線通」如何發水？",annotation:["點擊這裡開始"],annotation_point:[3335],annotation_dxdy:[{dx:1,dy:-2}],range:[{start:0,end:6750,color:m,opacity:.2}]},{title:"截至2017年3月3日，網站共有6,751項數據資源。",annotation:["一點等於一項資源"],annotation_point:[3330],annotation_dxdy:[!1],range:[{start:0,end:3329,color:m,opacity:.2},{start:3330,end:3330,color:"red",opacity:1},{start:3331,end:6750,color:m,opacity:.2}]},{title:"四分一資源為圖像檔案，可謂食之無味。",annotation:["JPG, PNG, GIF... 有1661項"],annotation_point:[5120],annotation_dxdy:[!1],range:[{start:5087,end:6750,color:v.rubbish,opacity:1},{start:0,end:5086,color:m,opacity:.2}]},{title:"屬二星的XLS／XLSX格式佔網站近六成資源。",annotation:["XLS／XLSX有3,996項"],annotation_point:[1120],annotation_dxdy:[{dx:20,dy:-20}],range:[{start:0,end:1119,color:m,opacity:.2},{start:1120,end:5086,color:v.fair,opacity:1},{start:5087,end:6750,color:v.rubbish,opacity:.4}]},{title:"三星格式包括：JSON, XML, CSV只佔網站六分一資源。",annotation:["JSON, XML, CSV 有1,120項"],annotation_point:[1120],annotation_dxdy:[{dx:20,dy:20}],range:[{start:0,end:1119,color:v.good,opacity:1},{start:1120,end:5086,color:v.fair,opacity:.4},{start:5087,end:6750,color:v.rubbish,opacity:.4}]},{title:"不過，政府把同一項數據以不同語言和日期分拆上載。",annotation:["多項資源應歸納為同一個數據資源","","",""],annotation_point:[3310,515,1190,5180],annotation_dxdy:[!1,{dx:60,dy:80},{dx:-50,dy:50},{dx:-80,dy:-100}],range:[{start:0,end:6750,color:m,opacity:function(){return function(){return Math.random()}()}}]},{title:"不過，政府把同一項數據以不同語言和日期分拆上載。",annotation:["338項拆成2種語言","772項拆成繁簡英3種","45項分身成810項資源"],annotation_point:[4104,4631,6087],annotation_dxdy:[{dx:50,dy:-50},{dx:30,dy:-30},{dx:-1,dy:-190}],range:[{start:0,end:4103,color:m,opacity:.2},{start:4104,end:4441,color:v.lesserrubbish,opacity:.8},{start:4442,end:5985,color:v.lessrubbish,opacity:1},{start:5986,end:6750,color:v.rubbish,opacity:1}]},{title:"扣除上述重覆語言、不同角度拍攝的圖片資源，網站僅餘4,104項資源。",annotation:["餘下4,104項"],annotation_point:[4103],annotation_dxdy:[{dx:30,dy:30}],range:[{start:0,end:4103,color:v.fair,opacity:1},{start:4104,end:6750,color:m,opacity:.2}]},{title:"再扣除同一個數據，發水成每年一項、每月一項的資源。",annotation:["僅餘2,025項獨立的數據資源"],annotation_point:[1312],annotation_dxdy:[{dx:70,dy:70}],range:[{start:0,end:2024,color:v.good,opacity:1},{start:2025,end:4103,color:v.fair,opacity:.4},{start:4104,end:6750,color:m,opacity:.2}]},{title:"6,751項數據資源，七除八扣下只餘2,025項「真材實料」，換言之網站有七成水份。",annotation:["357項是三粒星","1,193項是兩粒星","其他資源"],annotation_point:[204,1312,1970],annotation_dxdy:[{dx:1,dy:190},{dx:70,dy:70},{dx:20,dy:20}],range:[{start:0,end:356,color:v.good,opacity:1},{start:357,end:1549,color:v.fair,opacity:1},{start:1550,end:2024,color:v.rubbish,opacity:1},{start:2025,end:6750,color:m,opacity:.2}]}],x="WebGL";PIXI.utils.isWebGLSupported()?(p=PIXI.autoDetectRenderer(470,369),p.backgroundColor=16777215,document.getElementById("chart").appendChild(p.view),s=new PIXI.Container,p.render(s)):(x="canvas",l=d3.select("#chart").append("canvas").attr("id","canvas").attr("width",r).attr("height",i),s=l.node().getContext("2d"));var w,I=document.getElementById("control"),L=(document.getElementById("prev-page"),document.getElementById("next-page"),document.getElementById("nav-group"));for(w=0;w<_.length;w++){var P=document.createElement("button");P.className="nav-page",P.value=w+1,P.innerHTML=w+1,I.insertBefore(P,L)}var X=[100,150,200,350,215,179,465,321].sort(function(){return.5-Math.random()}),A=function(t,n){var e=document.getElementById(t);e.innerHTML=n},C=function(t,n,e,a,o){t.fillStyle=o,t.beginPath(),t.arc(n,e,a,0,2*Math.PI,!0),t.fill(),t.closePath()},S=function(t,n){return n},W=function(t,n,e){var a=n,o=n;return.3>n||c.isFirefox||c.is_uiwebview?a=n:(o=X[~~((10*Math.random()+1)%8)]/500*(n-e/d)+e/d,a=t+o*(n-t)),a},E=function(t,r){var i,d,l,s,u,g,f=_[c.curr_page-1];for(d=0;y>d;d++){if(u=~~(d/n)*e+a,s=d%n*e+a,f.range){for(i=!1,l=0;l<f.range.length&&(f.range[l].start>d||d>f.range[l].end);)l++;l<f.range.length&&(f.range[l].start>d||d>f.range[l].end||(g=S(f.range[l].color,f.range[l].color,r),t.globalAlpha="function"==typeof f.range[l].opacity?W(.2,f.range[l].opacity(),r):W(.2,f.range[l].opacity,r),i=!0))}else g=m,t.globalAlpha=.2,i=!0;if(i)if(p instanceof PIXI.WebGLRenderer){var b=new PIXI.Graphics;b.beginFill(parseInt("0x"+g.replace("#",""),16),t.globalAlpha),b.drawRect(0,0,o,o),b.endFill(),b.x=s,b.y=u,t.addChild(b)}else C(t,s,u,o,g)}},G=30;c.is_uiwebview&&(G=12);var F,M,N,B=1e3/G,R=Date.now(),q=function(t){if(N=t-u,F=Date.now(),M=F-R,d>N){if(p instanceof PIXI.WebGLRenderer)for(;s.children.length>0;){var n=s.getChildAt(0);s.removeChild(n)}M>B&&(E(s,N),p instanceof PIXI.WebGLRenderer&&p.render(s),R=F-M%B),c.animator=window.requestAnimationFrame(q)}else g.className=" ",window.cancelAnimationFrame(c.animator)};c.is_uiwebview&&(q=function(){if(p instanceof PIXI.WebGLRenderer)for(;s.children.length>0;){var t=s.getChildAt(0);s.removeChild(t)}E(s,d),p instanceof PIXI.WebGLRenderer&&(p.render(s),g.className=" ")});var O=function(){u=performance.now(),window.requestAnimationFrame(q)},k=function(t,n){"prev"===t?~~c.curr_page-1<1?c.curr_page=_.length-1:c.curr_page--:"next"===t?~~c.curr_page+1>_.length?c.curr_page=1:c.curr_page++:c.curr_page=n;var e=document.querySelector(".nav-page.active");return e&&(e.className="nav-page"),document.querySelector('.nav-page[value="'+c.curr_page+'"]').className+=" active",c.curr_page};d3.select("#chart").on("click",function(){{var t;d3.mouse(this)[0],d3.mouse(this)[1]}return c.is_uiwebview&&(g.className+=" inter"),window.cancelAnimationFrame(c.animator),t=_[k("next",0)-1],A("ctitle",t.title),O(),D(t.annotation,t.annotation_point,t.annotation_dxdy),!1}),d3.selectAll("#control button").on("click.button",function(t,n,e){var a,o=e[n].value;return c.is_uiwebview&&(g.className+=" inter"),window.cancelAnimationFrame(c.animator),a=_[k(o,o)-1],A("ctitle",a.title),O(),D(a.annotation,a.annotation_point,a.annotation_dxdy),!1});var D=function(t,n,e){var a,o=document.querySelectorAll("."+f+" *");if(o)for(a=0;a<o.length;a++)o[a].remove();if(t)for(a=0;a<t.length;a++)H(t[a],n[a],e[a])},H=function(t,r,i){var d=~~(r/n)*e+a,c=r%n*e+a,l=i.dx||30,s=i.dy||-20,u=(d3.annotationCalloutElbow,[{note:{label:t},x:c+o,y:d-o,dx:l,dy:s,type:d3.annotationCalloutElbow}]),p=d3.annotation().annotations(u);d3.select("#chart svg").attr("class",f).append("g").attr("class","annotation-group").call(p)},J=_[k(1,1)-1];O(),D(J.annotation,J.annotation_point,J.annotation_dxdy)}();
!function(){"use strict";var t,n,a,o,e,r,i,d,c,l,s,u,p=70,y=100,g=(Math.pow(80,2),5),m=10,f=3,b=y*g+2*m,h=p*g+2*m,v=600,_=6751,x="annotation",w="#999999",I={};I.curr_page=1,I.animator={};var L={good:"#8913db",fair:"#597ddf",lesserrubbish:"#e1e318",lessrubbish:"#e3bb18",rubbish:"#ae8e0c"},X=[{title:"「資料一線通」如何發水？",annotation:["點擊這裡開始"],annotation_point:[3335],annotation_dxdy:[{dx:1,dy:-2}],range:[{start:0,end:6750,color:w,opacity:.2}]},{title:"截至2017年3月3日，網站共有6,751項數據資源。",annotation:["一點等於一項資源"],annotation_point:[3330],annotation_dxdy:[!1],range:[{start:0,end:3329,color:w,opacity:.2},{start:3330,end:3330,color:"red",opacity:1},{start:3331,end:6750,color:w,opacity:.2}]},{title:"四分一資源為圖像檔案，可謂食之無味。",annotation:["JPG, PNG, GIF... 有1661項"],annotation_point:[5120],annotation_dxdy:[!1],range:[{start:5087,end:6750,color:L.rubbish,opacity:1},{start:0,end:5086,color:w,opacity:.2}]},{title:"屬二星的XLS／XLSX格式佔網站近六成資源。",annotation:["XLS／XLSX有3,996項"],annotation_point:[1120],annotation_dxdy:[{dx:20,dy:-20}],range:[{start:0,end:1119,color:w,opacity:.2},{start:1120,end:5086,color:L.fair,opacity:1},{start:5087,end:6750,color:L.rubbish,opacity:.4}]},{title:"三星格式包括：JSON, XML, CSV只佔網站六分一資源。",annotation:["JSON, XML, CSV 有1,120項"],annotation_point:[1120],annotation_dxdy:[{dx:20,dy:20}],range:[{start:0,end:1119,color:L.good,opacity:1},{start:1120,end:5086,color:L.fair,opacity:.4},{start:5087,end:6750,color:L.rubbish,opacity:.4}]},{title:"不過，政府把同一項數據以不同語言和日期分拆上載。",annotation:["多項資源應歸納為同一個數據資源","","",""],annotation_point:[3310,515,1190,5180],annotation_dxdy:[!1,{dx:60,dy:80},{dx:-50,dy:50},{dx:-80,dy:-100}],range:[{start:0,end:6750,color:w,opacity:function(){return function(){return Math.random()}()}}]},{title:"不過，政府把同一項數據以不同語言和日期分拆上載。",annotation:["338項拆成2種語言","772項拆成繁簡英3種","45項分身成810項資源"],annotation_point:[4104,4631,6087],annotation_dxdy:[{dx:50,dy:-50},{dx:30,dy:-30},{dx:-1,dy:-190}],range:[{start:0,end:4103,color:w,opacity:.2},{start:4104,end:4441,color:L.lesserrubbish,opacity:.8},{start:4442,end:5985,color:L.lessrubbish,opacity:1},{start:5986,end:6750,color:L.rubbish,opacity:1}]},{title:"扣除上述重覆語言、不同角度拍攝的圖片資源，網站僅餘4,104項資源。",annotation:["餘下4,104項"],annotation_point:[4103],annotation_dxdy:[{dx:30,dy:30}],range:[{start:0,end:4103,color:L.fair,opacity:1},{start:4104,end:6750,color:w,opacity:.2}]},{title:"再扣除同一個數據，發水成每年一項、每月一項的資源。",annotation:["僅餘2,025項獨立的數據資源"],annotation_point:[1312],annotation_dxdy:[{dx:70,dy:70}],range:[{start:0,end:2024,color:L.good,opacity:1},{start:2025,end:4103,color:L.fair,opacity:.4},{start:4104,end:6750,color:w,opacity:.2}]},{title:"6,751項數據資源，七除八扣下只餘2,025項「真材實料」，換言之網站有七成水份。",annotation:["357項是三粒星","1,193項是兩粒星","其他資源"],annotation_point:[204,1312,1970],annotation_dxdy:[{dx:1,dy:190},{dx:70,dy:70},{dx:20,dy:20}],range:[{start:0,end:356,color:L.good,opacity:1},{start:357,end:1549,color:L.fair,opacity:1},{start:1550,end:2024,color:L.rubbish,opacity:1},{start:2025,end:6750,color:w,opacity:.2}]}];for(t=d3.select("#chart").append("canvas").attr("id","canvas").attr("width",b).attr("height",h),n=t.node().getContext("2d"),d=document.getElementById("chart"),c=document.getElementById("control"),l=document.getElementById("prev-page"),s=document.getElementById("next-page"),u=document.getElementById("nav-group"),a=0;a<X.length;a++){var A=document.createElement("button");A.className="nav-page",A.value=a+1,A.innerHTML=a+1,c.insertBefore(A,u)}o=document.body.offsetWidth||document.body.clientWidth,470>o&&(d.style.transform+=" scale("+(o-.6*m)/470+") ",d.style.transformOrigin=" 0 0 ",d.style.marginBottom=-(100-o/470*100)+"%"),ga("create","UA-67838455-1",{name:"b"}),ga("b.send","pageview",{});var S=document.createElement("p");S.innerHTML=document.body.offsetWidth+", "+document.body.clientWidth+", "+o+" : ";var P=[100,150,200,350,215,179,465,321].sort(function(){return.5-Math.random()}),C=function(t,n){var a=document.getElementById(t);a.innerHTML=n},E=function(t,n,a,o,e,r){e=e.replace("#","");var d=y*g+2*m,c=4*(a*d+n-m);d=4*d,i[c+0]=i[c+0+4+d]=i[c+0+0+d]=i[c+0+4]=parseInt(e.substr(0,2),16),i[c+1]=i[c+1+4+d]=i[c+1+0+d]=i[c+1+4]=parseInt(e.substr(2,2),16),i[c+2]=i[c+2+4+d]=i[c+2+0+d]=i[c+2+4]=parseInt(e.substr(4,2),16),i[c+3]=i[c+3+4+d]=i[c+3+0+d]=i[c+3+4]=255*r,i[c+0+4+2*d]=i[c+0+8+d]=i[c+0+0+2*d]=i[c+0+8]=parseInt(e.substr(0,2),16),i[c+1+4+2*d]=i[c+1+8+d]=i[c+1+0+2*d]=i[c+1+8]=parseInt(e.substr(2,2),16),i[c+2+4+2*d]=i[c+2+8+d]=i[c+2+0+2*d]=i[c+2+8]=parseInt(e.substr(4,2),16),i[c+3+4+2*d]=i[c+3+8+d]=i[c+3+0+2*d]=i[c+3+8]=255*r,i[c+0+8+2*d]=parseInt(e.substr(0,2),16),i[c+1+8+2*d]=parseInt(e.substr(2,2),16),i[c+2+8+2*d]=parseInt(e.substr(4,2),16),i[c+3+8+2*d]=255*r},M=function(t,n){return n},W=function(t,n,a){var o=n,e=n;return.3>n?o=n:(e=P[~~((10*Math.random()+1)%8)]/500*(n-a/v)+a/v,o=t+e*(n-t)),o},F=function(t,n){var a,o,e,d,c,l,s=X[I.curr_page-1];for(i=(r=t.createImageData(b,h)).data,o=0;_>o;o++){if(c=~~(o/y)*g+m,d=o%y*g+m,s.range){for(a=!1,e=0;e<s.range.length&&(s.range[e].start>o||o>s.range[e].end);)e++;e<s.range.length&&(s.range[e].start>o||o>s.range[e].end||(l=M(s.range[e].color,s.range[e].color,n),t.globalAlpha="function"==typeof s.range[e].opacity?W(.2,s.range[e].opacity(),n):W(.2,s.range[e].opacity,n),a=!0))}else l=w,t.globalAlpha=.2,a=!0;a&&E(t,d,c,f,l,t.globalAlpha)}},N=function(t){var a=t-e;v>a?(F(n,a),n.putImageData(r,0,0),I.animator=window.requestAnimationFrame(N)):window.cancelAnimationFrame(I.animator)},B=function(){e=performance.now(),window.requestAnimationFrame(N)},G=function(t,n){"prev"===t?~~I.curr_page-1<1?I.curr_page=X.length-1:I.curr_page--:"next"===t?~~I.curr_page+1>X.length?I.curr_page=1:I.curr_page++:I.curr_page=n;var a=document.querySelector(".nav-page.active");return a&&(a.className="nav-page"),document.querySelector('.nav-page[value="'+I.curr_page+'"]').className+=" active",I.curr_page};d3.select("#chart").on("click",function(){{var t,n="hk01.com"===window.location.hostname?"user-interaction":"interaction";d3.mouse(this)[0],d3.mouse(this)[1]}return window.cancelAnimationFrame(I.animator),t=X[G("next",0)-1],C("ctitle",t.title),B(),q(t.annotation,t.annotation_point,t.annotation_dxdy),ga("b.send","event",n,"click-svg",I.curr_page),!1}),d3.selectAll("#control button").on("click.button",function(t,n,a){var o,e="github.io"===window.location.hostname?"user-interaction":"interaction",r=a[n].value;return window.cancelAnimationFrame(I.animator),o=X[G(r,r)-1],C("ctitle",o.title),B(),q(o.annotation,o.annotation_point,o.annotation_dxdy),ga("b.send","event",e,"click-nav",I.curr_page),!1});var q=function(t,n,a){var o,e=document.querySelectorAll("."+x+" *");if(e)for(o=0;o<e.length;o++)e[o].remove();if(t)for(o=0;o<t.length;o++)R(t[o],n[o],a[o])},R=function(t,n,a){var o=~~(n/y)*g+m,e=n%y*g,r=a.dx||30,i=a.dy||-20,d=(d3.annotationCalloutElbow,[{note:{label:t},x:e+f,y:o-f,dx:r,dy:i,type:d3.annotationCalloutElbow}]),c=d3.annotation().annotations(d);d3.select("#chart svg").attr("class",x).append("g").attr("class","annotation-group").call(c)},O=X[G(1,1)-1];B(),q(O.annotation,O.annotation_point,O.annotation_dxdy)}();